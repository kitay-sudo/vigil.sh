<p align="center">
  <img src="img/vigilsh.png" alt="Vigil.sh Logo" width="200"/>
</p>

<h1 align="center">Vigil.sh</h1>

<p align="center">
  <strong>–°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã Linux —Å–µ—Ä–≤–µ—Ä–∞ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram</strong>
</p>

<p align="center">
  <a href="https://github.com/kitay-sudo/vigil.sh/blob/main/LICENSE"><img src="https://img.shields.io/badge/license-MIT-green.svg" alt="License: MIT"></a>
  <img src="https://img.shields.io/badge/python-3.7+-blue.svg" alt="Python 3.7+">
  <img src="https://img.shields.io/badge/platform-Linux-lightgrey.svg" alt="Platform: Linux">
  <img src="https://img.shields.io/badge/telegram-notifications-blue.svg?logo=telegram" alt="Telegram">
  <a href="https://github.com/kitay-sudo/vigil.sh/stargazers"><img src="https://img.shields.io/github/stars/kitay-sudo/vigil.sh?style=social" alt="GitHub Stars"></a>
</p>

---

```
üî¥ –¢–†–ï–í–û–ì–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
üñ• –°–µ—Ä–≤–µ—Ä: production-web-1 (xx.xx.xx.xx)

–¢–∏–ø: SSH Brute Force
–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å: HIGH
IP: xx.xx.xx.xx
–°—Ç—Ä–∞–Ω–∞: China (CN)
–í—Ä–µ–º—è: 01:25:33 (MSK)

–î–µ—Ç–∞–ª–∏:
Detected 15 failed SSH login attempts.
SSH access should only come from whitelisted IPs.
This IP is NOT in SSH whitelist.

–î–µ–π—Å—Ç–≤–∏–µ: IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
–í—Å–µ–≥–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 169 IP-–∞–¥—Ä–µ—Å–æ–≤
```

## –ß—Ç–æ —ç—Ç–æ –∑–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç?

Vigil.sh ‚Äî —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è Linux —Å–µ—Ä–≤–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–π:

- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∞—Ç–∞–∫–∏** —á–µ—Ä–µ–∑ iptables
- **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram** –æ –∫–∞–∂–¥–æ–π —É–≥—Ä–æ–∑–µ
- **–†–∞–∑–ª–∏—á–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∞—Ç–∞–∫–∏ –∏ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
- **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Äî –æ—Ç–∫–ª—é—á–∏—Ç–µ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ç–æ–ª—å–∫–æ –∫–ª—é—á–∏
- **–ë–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏ IP** ‚Äî –∑–∞—â–∏—Ç–∞ –≤–∞—à–∏—Ö –∞–¥–º–∏–Ω—Å–∫–∏—Ö IP –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

Vigil.sh –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥:
- –õ–æ–≥–∏ SSH (`/var/log/auth.log`) ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞
- –°–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (`netstat`) ‚Äî –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç DDoS –∞—Ç–∞–∫–∏
- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤

–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É–≥—Ä–æ–∑—ã:
1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∞ –∞—Ç–∞–∫—É—é—â–µ–≥–æ (GeoIP)
2. –û—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —Å–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å —É–≥—Ä–æ–∑—ã (LOW ‚Üí CRITICAL)
3. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ: –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —Ç–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å
4. IP –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ iptables DROP (–µ—Å–ª–∏ —É–≥—Ä–æ–∑–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞)
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

**üõ° –£–º–Ω–∞—è –∑–∞—â–∏—Ç–∞**
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç SSH –∞—Ç–∞–∫–∏ (–±—Ä—É—Ç—Ñ–æ—Ä—Å, –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ IP)
- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç DDoS (SYN Flood)
- –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤
- –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–∞–π—Ç–∞

**‚ö° –†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ systemd —Å–µ—Ä–≤–∏—Å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
- –°–∞–º–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—á–∞—Å—Ç–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**üì± Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã –æ –∫–∞–∂–¥–æ–π –∞—Ç–∞–∫–µ
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—Ä–∞–Ω–µ –∞—Ç–∞–∫—É—é—â–µ–≥–æ
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –≤ 9:00 MSK
- Rate limiting (–Ω–µ —Å–ø–∞–º–∏—Ç –ø—Ä–∏ –º–∞—Å—Å–æ–≤—ã—Ö –∞—Ç–∞–∫–∞—Ö)

**üéØ –î–≤–∞ —Ç–∏–ø–∞ –∑–∞—â–∏—Ç—ã**
- **SSH** ‚Äî –∂—ë—Å—Ç–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (—Ç–æ–ª—å–∫–æ whitelist)
- **HTTP** ‚Äî —Ç–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤)

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd /opt
git clone https://github.com/vigilsh/Vigil.sh.git security-monitor
cd security-monitor
chmod +x install.sh
sudo ./install.sh
```

–£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–°–ø—Ä–æ—Å–∏—Ç –ø—Ä–æ SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (–≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å)
- **–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç –ø–æ—Ä—Ç SSH** (–º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤—Ä—É—á–Ω—É—é)
- –ó–∞–ø—Ä–æ—Å–∏—Ç **SSH whitelist** (–≤–∞—à–∏ –∞–¥–º–∏–Ω—Å–∫–∏–µ IP)
- –ó–∞–ø—Ä–æ—Å–∏—Ç **Service whitelist** (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã)
- –°–æ–∑–¥–∞—Å—Ç systemd —Å–µ—Ä–≤–∏—Å
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
- –ó–∞–ø—É—Å—Ç–∏—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

–£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –∑–∞–¥–∞—Å—Ç –≤–∞–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤:

1. **–ò–º—è —Å–µ—Ä–≤–µ—Ä–∞** ‚Äî –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Production API")
2. **SSH Whitelist** ‚Äî IP –∞–¥–º–∏–Ω–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 94.241.174.106)
3. **Service Whitelist** ‚Äî IP –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (MongoDB, Redis –∏ —Ç.–¥.)
4. **Telegram Bot Token** ‚Äî –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å)
5. **Telegram Chat ID** ‚Äî –≤–∞—à ID –≤ Telegram
6. **–í–∫–ª—é—á–∏—Ç—å SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥?** ‚Äî y/n (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ç–æ–ª—å–∫–æ –∫–ª—é—á–∏ - –º–æ–∂–Ω–æ n)
7. **–ü–æ—Ä—Ç SSH** ‚Äî –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è, –º–æ–∂–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–∏—Ç–µ Telegram credentials

**Bot Token:**
1. –ù–∞–ø–∏—à–∏—Ç–µ @BotFather –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω

**Chat ID:**
1. –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–µ–º—É –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ `https://api.telegram.org/bot<TOKEN>/getUpdates`
3. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":123456789}`

### 2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ config.json

```json
{
  "server_name": "Production API",
  "language": "ru",
  "ssh_port": 22,
  "enable_ssh_monitoring": true,
  "ssh_whitelist": [
    "xx.xx.xx.xx"
  ],
  "service_whitelist": [
    "127.0.0.1",
    "xx.xx.xx.xx"
  ],
  "telegram": {
    "bot_token": "YOUR_BOT_TOKEN_HERE",
    "chat_id": "YOUR_CHAT_ID_HERE"
  },
  "thresholds": {
    "syn_recv_max": 50,
    "syn_recv_per_ip_min": 15,
    "failed_ssh_max": 5,
    "http_connections_per_ip_max": 100,
    "ssh_connections_per_ip_max": 3
  },
  "protection": {
    "block_ssh_bruteforce": true,
    "block_unknown_ssh": true,
    "block_syn_flood": true,
    "block_excessive_http": false,
    "notify_excessive_http": true
  },
  "check_interval_seconds": 60,
  "auto_block": true
}
```

### –ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥–∞

**server_name** ‚Äî –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–∞–∂–¥–æ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏
- –ü–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å —Å–µ—Ä–≤–µ—Ä—ã, –µ—Å–ª–∏ —É –≤–∞—Å –∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ

**ssh_port** ‚Äî –ø–æ—Ä—Ç SSH (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22)
- –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç SSH
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

**enable_ssh_monitoring** ‚Äî –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- `true` ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å SSH –∞—Ç–∞–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `false` ‚Äî –æ—Ç–∫–ª—é—á–∏—Ç—å SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ç–æ–ª—å–∫–æ –∫–ª—é—á–∏)
- –ü—Ä–∏ `false` –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS/—Ñ–ª—É–¥–∞

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ whitelist'–æ–≤

**ssh_whitelist** ‚Äî IP –∞–¥—Ä–µ—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –¢–æ–ª—å–∫–æ —ç—Ç–∏ IP –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø–æ SSH (–µ—Å–ª–∏ SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–∫–ª—é—á—ë–Ω)
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ = BLOCK
- **–í–∞–∂–Ω–æ:** –≠—Ç–∏ IP –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –∑–∞ SSH –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ü—Ä–∏–º–µ—Ä: –≤–∞—à –¥–æ–º–∞—à–Ω–∏–π IP, –æ—Ñ–∏—Å–Ω—ã–π IP, VPN IP

**service_whitelist** ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∫—ç—à, –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
- **–í–∞–∂–Ω–æ:** –≠—Ç–∏ IP –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –≤–æ–æ–±—â–µ (–∑–∞ –ª—é–±—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
- –ü—Ä–∏–º–µ—Ä: MongoDB (89.223.64.38), Redis, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ API
- Localhost (127.0.0.1) –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### üîê –î–ª—è —Å–µ—Ä–≤–µ—Ä–∞ —Å SSH –ø–æ –∫–ª—é—á–∞–º (–±–µ–∑ –ø–∞—Ä–æ–ª–µ–π)

**–°–∏—Ç—É–∞—Ü–∏—è:** –í—ã –æ—Ç–∫–ª—é—á–∏–ª–∏ –ø–∞—Ä–æ–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é SSH (PasswordAuthentication no)

```json
{
  "enable_ssh_monitoring": false,
  "ssh_port": 22,
  "ssh_whitelist": ["94.241.174.106"],
  "service_whitelist": ["127.0.0.1", "89.223.64.38"],
  "protection": {
    "block_ssh_bruteforce": false,
    "block_unknown_ssh": false,
    "block_syn_flood": true,
    "block_excessive_http": false
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë—Ä—É—Ç—Ñ–æ—Ä—Å SSH –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω (–Ω–µ—Ç –ø–∞—Ä–æ–ª–µ–π)
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ DDoS/—Ñ–ª—É–¥
- –ù–µ —Ç—Ä–∞—Ç–∏—Ç —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É SSH –ª–æ–≥–æ–≤

#### üîë –î–ª—è —Å–µ—Ä–≤–µ—Ä–∞ —Å –ø–∞—Ä–æ–ª—å–Ω—ã–º SSH

**–°–∏—Ç—É–∞—Ü–∏—è:** SSH –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –ø–∞—Ä–æ–ª—é (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

```json
{
  "enable_ssh_monitoring": true,
  "ssh_port": 22,
  "ssh_whitelist": ["94.241.174.106", "YOUR_HOME_IP"],
  "service_whitelist": ["127.0.0.1"],
  "protection": {
    "block_ssh_bruteforce": true,
    "block_unknown_ssh": true,
    "block_syn_flood": true,
    "block_excessive_http": false
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–æ–ª–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç SSH –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö IP
- –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS

#### üåê –î–ª—è —Å–µ—Ä–≤–µ—Ä–∞ —Å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –ø–æ—Ä—Ç–æ–º SSH

```json
{
  "enable_ssh_monitoring": true,
  "ssh_port": 2222,
  "ssh_whitelist": ["YOUR_IP"]
}
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º

```bash
# –°—Ç–∞—Ç—É—Å
systemctl status security-monitor

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
systemctl restart security-monitor

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
journalctl -u security-monitor -f
tail -f /var/log/security-monitor.log
```

### –ö–æ–º–∞–Ω–¥—ã

```bash
# –û–¥–Ω–æ–∫—Ä–∞—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
security-monitor --check-once

# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å (—Å –∏–Ω—Ñ–æ –æ SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ –∏ whitelist)
security-monitor --show-status

# –î–æ–±–∞–≤–∏—Ç—å IP –≤ SSH whitelist (–∞–¥–º–∏–Ω—ã)
security-monitor --add-ssh-whitelist 94.241.174.106

# –î–æ–±–∞–≤–∏—Ç—å IP –≤ Service whitelist (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã)
security-monitor --add-service-whitelist 89.223.64.38

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–ø—É—Ç–∞—Ü–∏—é IP (GeoIP + AbuseIPDB)
security-monitor --check-ip 8.8.8.8

# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á—ë—Ç
security-monitor --send-report
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è whitelist

**–î–æ–±–∞–≤–∏—Ç—å –≤–∞—à –¥–æ–º–∞—à–Ω–∏–π IP –≤ SSH whitelist:**
```bash
security-monitor --add-ssh-whitelist 94.241.174.106
systemctl restart security-monitor
```

**–î–æ–±–∞–≤–∏—Ç—å MongoDB —Å–µ—Ä–≤–µ—Ä –≤ service whitelist:**
```bash
security-monitor --add-service-whitelist 89.223.64.38
systemctl restart security-monitor
```

**–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–µ whitelist:**
```bash
security-monitor --show-status
```

–í—ã–≤–æ–¥:
```
Security Monitor v2.1
Server: Production API (xx.xx.xx.xx)
SSH Monitoring: ‚úÖ ENABLED (port 22)
SSH Whitelist (admin IPs): {'94.241.174.106'}
Service Whitelist (internal): {'127.0.0.1', '89.223.64.38'}
Blocked IPs: 169
```

## –ß—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

| –¢–∏–ø —É–≥—Ä–æ–∑—ã | –î–µ–π—Å—Ç–≤–∏–µ | –ü—Ä–∏—á–∏–Ω–∞ | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ |
|------------|----------|---------|-------------|
| SSH –±—Ä—É—Ç—Ñ–æ—Ä—Å | üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | –ü–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–æ–ª—è | ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å |
| –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π SSH | üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | IP –Ω–µ –≤ whitelist | ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å |
| SYN Flood DDoS | üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | –ú–∞—Å—Å–æ–≤—ã–µ –ø–æ–ª—É–æ—Ç–∫—Ä—ã—Ç—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è | ‚ùå –í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–æ |
| –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ | üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | –ü–µ—Ä–µ–±–æ—Ä –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ | ‚úÖ –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å |
| –í—ã—Å–æ–∫–∏–π HTTP —Ç—Ä–∞—Ñ–∏–∫ | üëÅ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è |

### –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

**Whitelist —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫:**
- IP –∏–∑ **ssh_whitelist** ‚Üí –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∑–∞ SSH –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- IP –∏–∑ **service_whitelist** ‚Üí –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–æ–æ–±—â–µ
- Localhost (127.0.0.1) ‚Üí –≤—Å–µ–≥–¥–∞ –≤ whitelist –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "ssh_whitelist": ["94.241.174.106"],
  "service_whitelist": ["127.0.0.1", "89.223.64.38"]
}
```

- IP `94.241.174.106` –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø–æ SSH —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ
- IP `89.223.64.38` (MongoDB) –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ IP –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ —É–≥—Ä–æ–∑—ã

### –ü–æ—á–µ–º—É HTTP –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è?

100+ HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –æ–¥–Ω–æ–≥–æ IP –º–æ–≥—É—Ç –±—ã—Ç—å:
- –ê–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –≤–∫–ª–∞–¥–∫–∞–º–∏
- –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ü–æ–∏—Å–∫–æ–≤—ã–π –±–æ—Ç (Google, Yandex)
- CDN —Å–µ—Ä–≤–µ—Ä

**–ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å = –ø–æ—Ç–µ—Ä—è—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤!**

HTTP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ **SYN Flood** (—Å–æ—Ç–Ω–∏ SYN_RECV —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π) ‚Äî —ç—Ç–æ —è–≤–Ω–∞—è DDoS –∞—Ç–∞–∫–∞.

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

### üîÑ SYN Flood –∑–∞—â–∏—Ç–∞ - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**–ß—Ç–æ —Ç–∞–∫–æ–µ SYN_RECV?**

–ü—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º TCP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç 3-way handshake:

```
–ö–ª–∏–µ–Ω—Ç                    –°–µ—Ä–≤–µ—Ä
  |                          |
  |------- SYN ----------->  |  1. –ö–ª–∏–µ–Ω—Ç: "–•–æ—á—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è!"
  |                          |     –°—Ç–∞—Ç—É—Å: SYN_RECV (—Å–µ—Ä–≤–µ—Ä –∂–¥—ë—Ç)
  |                          |
  |<----- SYN-ACK --------- |  2. –°–µ—Ä–≤–µ—Ä: "–û–∫, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é!"
  |                          |
  |------- ACK ----------->  |  3. –ö–ª–∏–µ–Ω—Ç: "–ü—Ä–∏–Ω—è—Ç–æ!"
  |                          |     –°—Ç–∞—Ç—É—Å: ESTABLISHED
```

**SYN_RECV** = –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–¥–ª–∏—Ç—Å—è ~1-100 –º—Å –≤ –Ω–æ—Ä–º–µ)

**SYN Flood –∞—Ç–∞–∫–∞:**
–ê—Ç–∞–∫—É—é—â–∏–π –ø–æ—Å—ã–ª–∞–µ—Ç —Ç—ã—Å—è—á–∏ SYN –ø–∞–∫–µ—Ç–æ–≤, –Ω–æ –ù–ï –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ SYN-ACK:

```
–ê—Ç–∞–∫—É—é—â–∏–π                 –°–µ—Ä–≤–µ—Ä
  |                          |
  |------- SYN ----------->  |  SYN_RECV #1 (–∂–¥—ë—Ç ACK...)
  |------- SYN ----------->  |  SYN_RECV #2 (–∂–¥—ë—Ç ACK...)
  |------- SYN ----------->  |  SYN_RECV #3 (–∂–¥—ë—Ç ACK...)
  ... (–µ—â—ë 1000 —Ä–∞–∑) ...      –û—á–µ—Ä–µ–¥—å –ü–ï–†–ï–ü–û–õ–ù–ï–ù–ê!
  |  –ù–ï –û–¢–í–ï–ß–ê–ï–¢! ‚úñÔ∏è         |  –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
```

**–ö–∞–∫ Vigil.sh –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞—Ç–∞–∫—É:**

| –£—Å–ª–æ–≤–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ü–æ—è—Å–Ω–µ–Ω–∏–µ |
|---------|----------|-----------|
| –í—Å–µ–≥–æ SYN_RECV –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ | > 50 | –û–±—â–∏–π –ø–æ—Ä–æ–≥ (`syn_recv_max`) |
| SYN_RECV —Å –æ–¥–Ω–æ–≥–æ IP | ‚â• 15 | –ü—Ä–∏–∑–Ω–∞–∫ –∞—Ç–∞–∫–∏ (`syn_recv_per_ip_min`) |
| –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | 0-2 | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ ESTABLISHED |
| –ê—Ç–∞–∫—É—é—â–∏–π | 15-100+ | –í–∏—Å—è—Ç –∏ –Ω–µ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è |

**–ü—Ä–∏–º–µ—Ä—ã:**

‚úÖ **–ù–û–†–ú–ê - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è:**
```
–í—Å–µ–≥–æ SYN_RECV: 12
- 203.0.113.1:  2 SYN_RECV (–æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- 203.0.113.2:  1 SYN_RECV (Google –±–æ—Ç)
- 203.0.113.3:  3 SYN_RECV (–∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∏–µ–Ω—Ç)
```

üö® **–ê–¢–ê–ö–ê - –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è:**
```
–í—Å–µ–≥–æ SYN_RECV: 87
- 203.0.113.100:  45 SYN_RECV ‚Üê –ë–õ–û–ö–ò–†–û–í–ê–¢–¨!
- 203.0.113.101:  38 SYN_RECV ‚Üê –ë–õ–û–ö–ò–†–û–í–ê–¢–¨!
- 203.0.113.2:     2 SYN_RECV   (–Ω–æ—Ä–º–∞)
```

**–ó–∞—â–∏—Ç–∞ whitelist:**
IP –∏–∑ `service_whitelist` –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∞–∂–µ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º SYN_RECV.

```json
{
  "service_whitelist": ["89.223.64.38"],
  "thresholds": {
    "syn_recv_max": 50,
    "syn_recv_per_ip_min": 15
  }
}
```

### üîç Port Scan –∑–∞—â–∏—Ç–∞

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
–°–∫—Ä–∏–ø—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∫ –∫–∞–∫–∏–º –ø–æ—Ä—Ç–∞–º –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π IP:

```
–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
- 203.0.113.1 ‚Üí –ø–æ—Ä—Ç 80 (HTTP)
- 203.0.113.1 ‚Üí –ø–æ—Ä—Ç 443 (HTTPS)
–ò—Ç–æ–≥–æ: 2 –ø–æ—Ä—Ç–∞ ‚úÖ

–ê—Ç–∞–∫—É—é—â–∏–π (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ):
- 203.0.113.100 ‚Üí –ø–æ—Ä—Ç 22 (SSH)
- 203.0.113.100 ‚Üí –ø–æ—Ä—Ç 80 (HTTP)
- 203.0.113.100 ‚Üí –ø–æ—Ä—Ç 443 (HTTPS)
- 203.0.113.100 ‚Üí –ø–æ—Ä—Ç 3306 (MySQL)
- 203.0.113.100 ‚Üí –ø–æ—Ä—Ç 5432 (PostgreSQL)
- 203.0.113.100 ‚Üí –ø–æ—Ä—Ç 6379 (Redis)
- 203.0.113.100 ‚Üí –ø–æ—Ä—Ç 27017 (MongoDB)
... (–µ—â—ë 10 –ø–æ—Ä—Ç–æ–≤)
–ò—Ç–æ–≥–æ: 17 –ø–æ—Ä—Ç–æ–≤ –∑–∞ –º–∏–Ω—É—Ç—É üö® –ê–¢–ê–ö–ê!
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
```json
{
  "thresholds": {
    "port_scan_ports": 10,
    "port_scan_seconds": 60
  },
  "protection": {
    "block_port_scan": true
  }
}
```

### üõ°Ô∏è SSH –∑–∞—â–∏—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ö–æ–≥–¥–∞ –≤–∫–ª—é—á–∞—Ç—å:**
- ‚úÖ –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø–∞—Ä–æ–ª—å–Ω—ã–π –≤—Ö–æ–¥ SSH
- ‚úÖ –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ IP

**–ö–æ–≥–¥–∞ –≤—ã–∫–ª—é—á–∞—Ç—å:**
- ‚ùå –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ç–æ–ª—å–∫–æ SSH –∫–ª—é—á–∏ (`PasswordAuthentication no`)
- ‚ùå –ë—Ä—É—Ç—Ñ–æ—Ä—Å –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω –±–µ–∑ –ø–∞—Ä–æ–ª–µ–π

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è SSH –ø–æ –∫–ª—é—á–∞–º:**
```json
{
  "enable_ssh_monitoring": false,
  "protection": {
    "block_ssh_bruteforce": false,
    "block_unknown_ssh": false
  }
}
```

**–ß—Ç–æ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å:**
- ‚úÖ SYN Flood –∑–∞—â–∏—Ç–∞ (DDoS)
- ‚úÖ Port Scan –∑–∞—â–∏—Ç–∞
- ‚úÖ HTTP –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## –ü—Ä–∏–º–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### üü¢ –°—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
```
üü¢ –ú–æ–Ω–∏—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—â–µ–Ω

üñ• –°–µ—Ä–≤–µ—Ä: Production API
üåê IP: xx.xx.xx.xx
‚úÖ SSH Monitoring: ENABLED (port 22)
SSH Whitelist: 2 IP-–∞–¥—Ä–µ—Å–æ–≤
–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 168 IP-–∞–¥—Ä–µ—Å–æ–≤
–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏: 60s

–ó–∞—â–∏—Ç–∞:
‚Ä¢ SSH –±—Ä—É—Ç—Ñ–æ—Ä—Å: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π SSH: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ SYN Flood: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ HTTP —Ç—Ä–∞—Ñ–∏–∫: üëÅ –¢–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
‚Ä¢ ‚úÖ GeoIP
‚Ä¢ ‚úÖ Rate Limit
```

**–ï—Å–ª–∏ SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–∫–ª—é—á–µ–Ω:**
```
üü¢ –ú–æ–Ω–∏—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—â–µ–Ω

üñ• –°–µ—Ä–≤–µ—Ä: Production API
üåê IP: xx.xx.xx.xx
‚è∏ SSH Monitoring: DISABLED (port 22)
SSH Whitelist: 1 IP-–∞–¥—Ä–µ—Å–æ–≤
–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 168 IP-–∞–¥—Ä–µ—Å–æ–≤
–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏: 60s

–ó–∞—â–∏—Ç–∞:
‚Ä¢ SSH –±—Ä—É—Ç—Ñ–æ—Ä—Å: üëÅ –ú–æ–Ω–∏—Ç–æ—Ä
‚Ä¢ –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π SSH: üëÅ –ú–æ–Ω–∏—Ç–æ—Ä
‚Ä¢ SYN Flood: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ HTTP —Ç—Ä–∞—Ñ–∏–∫: üëÅ –¢–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

### üî¥ SSH –∞—Ç–∞–∫–∞ (–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è)
```
üî¥ –¢–†–ï–í–û–ì–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
üñ• –°–µ—Ä–≤–µ—Ä: production-web-1 (xx.xx.xx.xx)

–¢–∏–ø: SSH Brute Force
–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å: HIGH
IP: xx.xx.xx.xx
–°—Ç—Ä–∞–Ω–∞: China (CN)
–í—Ä–µ–º—è: 01:25:33 (MSK)

–î–µ—Ç–∞–ª–∏:
Detected 15 failed SSH login attempts.
SSH access should only come from whitelisted IPs.
This IP is NOT in SSH whitelist.

–î–µ–π—Å—Ç–≤–∏–µ: IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
–í—Å–µ–≥–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 169 IP-–∞–¥—Ä–µ—Å–æ–≤
```

### üü° HTTP —Ç—Ä–∞—Ñ–∏–∫ (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
```
üü° –¢–†–ï–í–û–ì–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
üñ• –°–µ—Ä–≤–µ—Ä: production-web-1 (xx.xx.xx.xx)

–¢–∏–ø: High HTTP Traffic
–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å: LOW
IP: xx.xx.xx.xx
–°—Ç—Ä–∞–Ω–∞: Germany (DE)
–í—Ä–µ–º—è: 14:52:18 (MSK)

–î–µ—Ç–∞–ª–∏:
IP has 150 HTTP/HTTPS connections (threshold: 100).
This might be a busy user or crawler.
NOT automatically blocked unless extreme.

–î–µ–π—Å—Ç–≤–∏–µ: –¢–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–í—Å–µ–≥–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 169 IP-–∞–¥—Ä–µ—Å–æ–≤
```

### üìä –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á—ë—Ç
```
üìä DAILY REPORT
üñ• production-web-1 (xx.xx.xx.xx)
2025-11-29

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Å—É—Ç–∫–∏:
‚Ä¢ –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ —É–≥—Ä–æ–∑: 47
‚Ä¢ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ IP: 12
‚Ä¢ –í—Å–µ–≥–æ –≤ –±–ª–æ–∫–µ: 180 IPs

–ü–æ —Ç–∏–ø–∞–º:
  ‚Ä¢ SSH Brute Force: 35
  ‚Ä¢ SYN Flood Attack: 8
  ‚Ä¢ Port Scan Detected: 4

–¢–æ–ø —Å—Ç—Ä–∞–Ω-–∞—Ç–∞–∫—É—é—â–∏—Ö:
  ‚Ä¢ China: 25
  ‚Ä¢ Russia: 12
  ‚Ä¢ United States: 6
  ‚Ä¢ India: 4
```

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Äî –≤—ã–∫–ª—é—á–∏—Ç–µ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ç–æ–ª—å–∫–æ –∫–ª—é—á–∏
- ‚úÖ **–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ SSH** ‚Äî —Å–∫—Ä–∏–ø—Ç —Å–∞–º –Ω–∞–π–¥—ë—Ç –≤–∞—à SSH –ø–æ—Ä—Ç
- ‚úÖ **–î–≤–∞ —Ç–∏–ø–∞ whitelist** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ SSH (–∞–¥–º–∏–Ω—ã) –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (–ë–î, –∫—ç—à)
- ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** ‚Äî IP –∏–∑ whitelist –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ **HTTP API** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
- ‚úÖ **GeoIP** ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã –∞—Ç–∞–∫—É—é—â–µ–≥–æ
- ‚úÖ **Rate Limit** ‚Äî –º–∞–∫—Å 5 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É (–Ω–µ —Å–ø–∞–º–∏—Ç –ø—Ä–∏ –º–∞—Å—Å–æ–≤—ã—Ö –∞—Ç–∞–∫–∞—Ö)
- ‚úÖ **Daily Report** ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –≤ 9:00 MSK
- ‚úÖ **–†—É—Å—Å–∫–∏–π/English** ‚Äî –≤—ã–±–æ—Ä —è–∑—ã–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ **Server Info** ‚Äî –∫–∞–∂–¥–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–º—è –∏ IP —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** ‚Äî –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –ª—é–±–æ–π —Ç–∏–ø –∑–∞—â–∏—Ç—ã

## HTTP API

Vigil.sh –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç HTTP API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API

**–í config.json:**
```json
{
  "api": {
    "enabled": true,
    "host": "0.0.0.0",
    "port": 8765
  }
}
```

**–î–æ—Å—Ç—É–ø:**
- –õ–æ–∫–∞–ª—å–Ω–æ: `http://localhost:8765/stats`
- –£–¥–∞–ª—ë–Ω–Ω–æ: `http://YOUR_SERVER_IP:8765/stats`
- –ß–µ—Ä–µ–∑ –¥–æ–º–µ–Ω: –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ nginx proxy (–ø—Ä–∏–º–µ—Ä –Ω–∏–∂–µ)

### API Endpoints

#### GET /health
–ü—Ä–æ—Å—Ç–æ–π healthcheck –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "uptime_seconds": 12345,
  "uptime_human": "3h 25m 45s",
  "timestamp": "2025-12-02T10:30:00.123456"
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
curl http://localhost:8765/health
```

#### GET /stats
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ —É–≥—Ä–æ–∑.

**–û—Ç–≤–µ—Ç:**
```json
{
  "blocked_ips_total": 169,
  "threats_detected_today": 47,
  "ips_blocked_today": 12,
  "threats_by_type": {
    "SSH Brute Force": 35,
    "SYN Flood Attack": 8,
    "Port Scan Detected": 4
  },
  "top_countries": [
    {"country": "China", "count": 25},
    {"country": "Russia", "count": 12},
    {"country": "United States", "count": 6}
  ],
  "last_reset": "2025-12-02",
  "timestamp": "2025-12-02T10:30:00.123456"
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
curl http://localhost:8765/stats | jq
```

#### GET /status
–ü–æ–ª–Ω—ã–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

**–û—Ç–≤–µ—Ç:**
```json
{
  "server_name": "Production API",
  "server_ip": "xx.xx.xx.xx",
  "status": "running",
  "uptime_seconds": 12345,
  "uptime_human": "3h 25m 45s",
  "ssh_monitoring": {
    "enabled": true,
    "port": 22
  },
  "protection": {
    "block_ssh_bruteforce": true,
    "block_unknown_ssh": true,
    "block_syn_flood": true,
    "block_excessive_http": false,
    "notify_excessive_http": true
  },
  "whitelist": {
    "ssh": ["94.241.174.106"],
    "service": ["127.0.0.1", "89.223.64.38"]
  },
  "statistics": {
    "blocked_ips_total": 169,
    "threats_detected_today": 47,
    "ips_blocked_today": 12,
    "threats_by_type": {
      "SSH Brute Force": 35
    },
    "last_check": "2025-12-02T10:29:00.123456"
  },
  "config": {
    "check_interval_seconds": 60,
    "auto_block": true,
    "language": "ru"
  },
  "integrations": {
    "telegram": true,
    "abuseipdb": false,
    "geoip": true
  },
  "timestamp": "2025-12-02T10:30:00.123456"
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
curl http://localhost:8765/status | jq
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å nginx

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä `monitor.example.com/api/stats`):

```nginx
server {
    listen 80;
    server_name monitor.example.com;

    location /api/ {
        proxy_pass http://localhost:8765/;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ:
- `http://monitor.example.com/api/health`
- `http://monitor.example.com/api/stats`
- `http://monitor.example.com/api/status`

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ uptime (healthcheck):**
```bash
#!/bin/bash
response=$(curl -s http://localhost:8765/health)
status=$(echo $response | jq -r '.status')

if [ "$status" != "ok" ]; then
    echo "Security monitor is DOWN!"
    # Send alert
fi
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞:**
```bash
curl -s http://localhost:8765/stats | jq '{
  blocked: .blocked_ips_total,
  today: .threats_detected_today,
  top_threat: .threats_by_type | to_entries | max_by(.value) | .key
}'
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```bash
curl -s http://localhost:8765/status | jq '{
  server: .server_name,
  ssh_monitoring: .ssh_monitoring.enabled,
  protections: .protection
}'
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API

**–í–∞–∂–Ω–æ:**
- API –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `0.0.0.0` (–≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)
- –î–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è (–Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ —á–µ—Ä–µ–∑ API)
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ —Ñ–∞–π—Ä–≤–æ–ª:

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å localhost
iptables -A INPUT -p tcp --dport 8765 ! -s 127.0.0.1 -j DROP

# –ò–ª–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö IP
iptables -A INPUT -p tcp --dport 8765 -s 94.241.174.106 -j ACCEPT
iptables -A INPUT -p tcp --dport 8765 -j DROP
```

**–ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ host –≤ –∫–æ–Ω—Ñ–∏–≥–µ:**
```json
{
  "api": {
    "enabled": true,
    "host": "127.0.0.1",  // –¢–æ–ª—å–∫–æ localhost
    "port": 8765
  }
}
```

## –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

```
/opt/security-monitor/
‚îú‚îÄ‚îÄ security_monitor.py      # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ config.json               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ config.example.json       # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞
‚îú‚îÄ‚îÄ install.sh                # –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫
‚îú‚îÄ‚îÄ requirements.txt          # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ security-commands.md  # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–∞–Ω–¥

/var/log/
‚îú‚îÄ‚îÄ security-monitor.log      # –õ–æ–≥ —Ä–∞–±–æ—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∞
‚îî‚îÄ‚îÄ blocked-ips.log           # –ò—Å—Ç–æ—Ä–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
```

## FAQ

**–ö–∞–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP?**
```bash
iptables -D INPUT -s 1.2.3.4 -j DROP
# –¢–∞–∫–∂–µ —É–¥–∞–ª–∏—Ç—å –∏–∑ /var/log/blocked-ips.log
```

**–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π IP –≤ whitelist?**
```bash
# –î–ª—è –∞–¥–º–∏–Ω–æ–≤ (SSH –¥–æ—Å—Ç—É–ø)
security-monitor --add-ssh-whitelist 94.241.174.106

# –î–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ (MongoDB, Redis –∏ —Ç.–¥.)
security-monitor --add-service-whitelist 89.223.64.38

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
systemctl restart security-monitor
```

**–ö–∞–∫ –æ—Ç–∫–ª—é—á–∏—Ç—å SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥?**
```bash
nano /opt/security-monitor/config.json
```

–ò–∑–º–µ–Ω–∏—Ç—å:
```json
{
  "enable_ssh_monitoring": false,
  "protection": {
    "block_ssh_bruteforce": false,
    "block_unknown_ssh": false
  }
}
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
systemctl restart security-monitor
```

**–ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç SSH?**
```json
{
  "ssh_port": 2222
}
```

**–ö–∞–∫ —Å–º–µ–Ω–∏—Ç—å —è–∑—ã–∫ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π?**
```json
{
  "language": "en"
}
```

**–ö–∞–∫ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫—É (—Ç–æ–ª—å–∫–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)?**
```json
{
  "auto_block": false
}
```

**–Ø –∏—Å–ø–æ–ª—å–∑—É—é —Ç–æ–ª—å–∫–æ SSH –∫–ª—é—á–∏, –Ω—É–∂–Ω–∞ –ª–∏ –º–Ω–µ –∑–∞—â–∏—Ç–∞ SSH?**

–ù–µ—Ç! –ï—Å–ª–∏ —É –≤–∞—Å –æ—Ç–∫–ª—é—á–µ–Ω –ø–∞—Ä–æ–ª—å–Ω—ã–π –≤—Ö–æ–¥ (`PasswordAuthentication no` –≤ `/etc/ssh/sshd_config`), —Ç–æ:
- SSH –±—Ä—É—Ç—Ñ–æ—Ä—Å –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω
- –ú–æ–∂–Ω–æ –≤—ã–∫–ª—é—á–∏—Ç—å SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (`enable_ssh_monitoring: false`)
- –û—Å—Ç–∞–Ω–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS/—Ñ–ª—É–¥–∞

**–ó–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –ª–∏ —Å–∫—Ä–∏–ø—Ç –º–æ–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã?**

–ù–µ—Ç! IP –∏–∑ `service_whitelist` **–Ω–∏–∫–æ–≥–¥–∞** –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è. –î–æ–±–∞–≤—å—Ç–µ —Ç—É–¥–∞:
- MongoDB —Å–µ—Ä–≤–µ—Ä
- Redis —Å–µ—Ä–≤–µ—Ä
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ API
- –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –≤–∞—à–∏ —Å–µ—Ä–≤–∏—Å—ã

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Å–ª—É—á–∞–π–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª —Å–µ–±—è?**

1. IP –∏–∑ `ssh_whitelist` –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è ‚Äî –¥–æ–±–∞–≤—å—Ç–µ —Ç—É–¥–∞ —Å–≤–æ–π IP
2. –ï—Å–ª–∏ —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏:
```bash
iptables -D INPUT -s YOUR_IP -j DROP
security-monitor --add-ssh-whitelist YOUR_IP
systemctl restart security-monitor
```

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Linux (Ubuntu, Debian, CentOS)
- Python 3.7+
- –î–æ—Å—Ç—É–ø root (–¥–ª—è iptables)
- –ò–Ω—Ç–µ—Ä–Ω–µ—Ç (–¥–ª—è Telegram API –∏ GeoIP)

## –ß—Ç–æ –Ω–æ–≤–æ–≥–æ?

**v2.2 - HTTP API –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** üÜï

- üöÄ **HTTP API Server** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
- üìä **–¢—Ä–∏ endpoint** ‚Äî /health, /stats, /status
- ‚è±Ô∏è **Uptime tracking** ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã
- üîå **nginx –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –¥–æ–º–µ–Ω
- üîí **Read-only API** ‚Äî —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- üí° **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** ‚Äî –≥–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**v2.1 - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ whitelist**

- ‚ú® **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π SSH –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Äî –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ç–æ–ª—å–∫–æ –∫–ª—é—á–∏
- ‚ú® **–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ SSH** ‚Äî —Å–∫—Ä–∏–ø—Ç —Å–∞–º –Ω–∞–π–¥—ë—Ç –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç
- ‚ú® **–£–ª—É—á—à–µ–Ω–Ω—ã–µ whitelist** ‚Äî —Ä–∞–∑–¥–µ–ª—å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚ú® **–ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** ‚Äî IP –∏–∑ whitelist –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚ú® **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞** ‚Äî –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–¥–∞—é—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

–°–º. [CHANGELOG.md](CHANGELOG.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - Vigil.sh 2025

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–µ—Ä–≤–µ—Ä–æ–≤ –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.**
