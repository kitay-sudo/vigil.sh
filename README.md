<p align="center">
  <img src="img/vigilsh.png" alt="Vigil.sh Logo" width="200"/>
</p>

<h1 align="center">Vigil.sh</h1>

<p align="center">
  <strong>–°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã Linux —Å–µ—Ä–≤–µ—Ä–∞ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram</strong>
</p>

<p align="center">
  <a href="https://github.com/kitay-sudo/vigil.sh/blob/main/LICENSE"><img src="https://img.shields.io/badge/license-MIT-green.svg" alt="License: MIT"></a>
  <img src="https://img.shields.io/badge/python-3.7+-blue.svg" alt="Python 3.7+">
  <img src="https://img.shields.io/badge/platform-Linux-lightgrey.svg" alt="Platform: Linux">
  <img src="https://img.shields.io/badge/telegram-notifications-blue.svg?logo=telegram" alt="Telegram">
  <a href="https://github.com/kitay-sudo/vigil.sh/stargazers"><img src="https://img.shields.io/github/stars/kitay-sudo/vigil.sh?style=social" alt="GitHub Stars"></a>
</p>

---

```
üî¥ –¢–†–ï–í–û–ì–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
üñ• –°–µ—Ä–≤–µ—Ä: production-web-1 (xx.xx.xx.xx)

–¢–∏–ø: SSH Brute Force
–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å: HIGH
IP: xx.xx.xx.xx
–°—Ç—Ä–∞–Ω–∞: China (CN)
–í—Ä–µ–º—è: 01:25:33 (MSK)

–î–µ—Ç–∞–ª–∏:
Detected 15 failed SSH login attempts.
SSH access should only come from whitelisted IPs.
This IP is NOT in SSH whitelist.

–î–µ–π—Å—Ç–≤–∏–µ: IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
–í—Å–µ–≥–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 169 IP-–∞–¥—Ä–µ—Å–æ–≤
```

## –ß—Ç–æ —ç—Ç–æ –∑–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç?

Vigil.sh ‚Äî —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è Linux —Å–µ—Ä–≤–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–π:

- **–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∞—Ç–∞–∫–∏** —á–µ—Ä–µ–∑ iptables
- **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram** –æ –∫–∞–∂–¥–æ–π —É–≥—Ä–æ–∑–µ
- **–†–∞–∑–ª–∏—á–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∞—Ç–∞–∫–∏ –∏ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

Vigil.sh –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥:
- –õ–æ–≥–∏ SSH (`/var/log/auth.log`) ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞
- –°–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (`netstat`) ‚Äî –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç DDoS –∞—Ç–∞–∫–∏
- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤

–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É–≥—Ä–æ–∑—ã:
1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∞ –∞—Ç–∞–∫—É—é—â–µ–≥–æ (GeoIP)
2. –û—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —Å–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å —É–≥—Ä–æ–∑—ã (LOW ‚Üí CRITICAL)
3. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ: –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —Ç–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å
4. IP –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ iptables DROP (–µ—Å–ª–∏ —É–≥—Ä–æ–∑–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞)
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

**üõ° –£–º–Ω–∞—è –∑–∞—â–∏—Ç–∞**
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç SSH –∞—Ç–∞–∫–∏ (–±—Ä—É—Ç—Ñ–æ—Ä—Å, –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ IP)
- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç DDoS (SYN Flood)
- –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤
- –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–∞–π—Ç–∞

**‚ö° –†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ systemd —Å–µ—Ä–≤–∏—Å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
- –°–∞–º–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—á–∞—Å—Ç–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**üì± Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã –æ –∫–∞–∂–¥–æ–π –∞—Ç–∞–∫–µ
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—Ä–∞–Ω–µ –∞—Ç–∞–∫—É—é—â–µ–≥–æ
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –≤ 9:00 MSK
- Rate limiting (–Ω–µ —Å–ø–∞–º–∏—Ç –ø—Ä–∏ –º–∞—Å—Å–æ–≤—ã—Ö –∞—Ç–∞–∫–∞—Ö)

**üéØ –î–≤–∞ —Ç–∏–ø–∞ –∑–∞—â–∏—Ç—ã**
- **SSH** ‚Äî –∂—ë—Å—Ç–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (—Ç–æ–ª—å–∫–æ whitelist)
- **HTTP** ‚Äî —Ç–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤)

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd /opt
git clone https://github.com/vigilsh/Vigil.sh.git security-monitor
cd security-monitor
chmod +x install.sh
sudo ./install.sh
```

–£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –°–æ–∑–¥–∞—Å—Ç systemd —Å–µ—Ä–≤–∏—Å
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
- –ó–∞–ø—É—Å—Ç–∏—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–∏—Ç–µ Telegram credentials

**Bot Token:**
1. –ù–∞–ø–∏—à–∏—Ç–µ @BotFather –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω

**Chat ID:**
1. –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–µ–º—É –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ `https://api.telegram.org/bot<TOKEN>/getUpdates`
3. –ù–∞–π–¥–∏—Ç–µ `"chat":{"id":123456789}`

### 2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ config.json

```json
{
  "language": "ru",
  "ssh_whitelist": [
    "xx.xx.xx.xx"
  ],
  "service_whitelist": [
    "127.0.0.1",
    "xx.xx.xx.xx"
  ],
  "telegram": {
    "bot_token": "YOUR_BOT_TOKEN_HERE",
    "chat_id": "YOUR_CHAT_ID_HERE"
  },
  "thresholds": {
    "syn_recv_max": 50,
    "syn_recv_per_ip_min": 15,
    "failed_ssh_max": 5,
    "http_connections_per_ip_max": 100,
    "ssh_connections_per_ip_max": 3
  },
  "protection": {
    "block_ssh_bruteforce": true,
    "block_unknown_ssh": true,
    "block_syn_flood": true,
    "block_excessive_http": false,
    "notify_excessive_http": true
  },
  "check_interval_seconds": 60
}
```

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ whitelist'–æ–≤

**ssh_whitelist** ‚Äî IP –∞–¥—Ä–µ—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –¢–æ–ª—å–∫–æ —ç—Ç–∏ IP –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø–æ SSH
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ = BLOCK

**service_whitelist** ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∫—ç—à, –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
- –ù–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º

```bash
# –°—Ç–∞—Ç—É—Å
systemctl status security-monitor

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
systemctl restart security-monitor

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
journalctl -u security-monitor -f
tail -f /var/log/security-monitor.log
```

### –ö–æ–º–∞–Ω–¥—ã

```bash
# –û–¥–Ω–æ–∫—Ä–∞—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
python3 security_monitor.py --check-once

# –î–æ–±–∞–≤–∏—Ç—å IP –≤ SSH whitelist
python3 security_monitor.py --add-ssh-whitelist 1.2.3.4

# –î–æ–±–∞–≤–∏—Ç—å IP –≤ service whitelist
python3 security_monitor.py --add-service-whitelist 1.2.3.4

# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
python3 security_monitor.py --show-status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–ø—É—Ç–∞—Ü–∏—é IP
python3 security_monitor.py --check-ip 8.8.8.8

# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á—ë—Ç
python3 security_monitor.py --send-report
```

## –ß—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

| –¢–∏–ø —É–≥—Ä–æ–∑—ã | –î–µ–π—Å—Ç–≤–∏–µ | –ü—Ä–∏—á–∏–Ω–∞ |
|------------|----------|---------|
| SSH –±—Ä—É—Ç—Ñ–æ—Ä—Å | üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | –ü–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–æ–ª—è |
| –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π SSH | üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | IP –Ω–µ –≤ whitelist |
| SYN Flood DDoS | üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | –ú–∞—Å—Å–æ–≤—ã–µ –ø–æ–ª—É–æ—Ç–∫—Ä—ã—Ç—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è |
| –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ | üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | –ü–µ—Ä–µ–±–æ—Ä –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ |
| –í—ã—Å–æ–∫–∏–π HTTP —Ç—Ä–∞—Ñ–∏–∫ | üëÅ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å |

### –ü–æ—á–µ–º—É HTTP –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è?

100+ HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –æ–¥–Ω–æ–≥–æ IP –º–æ–≥—É—Ç –±—ã—Ç—å:
- –ê–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –≤–∫–ª–∞–¥–∫–∞–º–∏
- –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ü–æ–∏—Å–∫–æ–≤—ã–π –±–æ—Ç (Google, Yandex)
- CDN —Å–µ—Ä–≤–µ—Ä

**–ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å = –ø–æ—Ç–µ—Ä—è—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤!**

HTTP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ **SYN Flood** (—Å–æ—Ç–Ω–∏ SYN_RECV —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π) ‚Äî —ç—Ç–æ —è–≤–Ω–∞—è DDoS –∞—Ç–∞–∫–∞.

## –ü—Ä–∏–º–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### üü¢ –°—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
```
üü¢ –ú–æ–Ω–∏—Ç–æ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—â–µ–Ω

üñ• –°–µ—Ä–≤–µ—Ä: production-web-1 (xx.xx.xx.xx)
SSH Whitelist: 1 IP-–∞–¥—Ä–µ—Å–æ–≤
–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 168 IP-–∞–¥—Ä–µ—Å–æ–≤
–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏: 60s

–ó–∞—â–∏—Ç–∞:
‚Ä¢ SSH –±—Ä—É—Ç—Ñ–æ—Ä—Å: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π SSH: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ SYN Flood: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤: üõ° –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
‚Ä¢ HTTP —Ç—Ä–∞—Ñ–∏–∫: üëÅ –¢–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
‚Ä¢ ‚úÖ GeoIP
‚Ä¢ ‚úÖ Rate Limit
```

### üî¥ SSH –∞—Ç–∞–∫–∞ (–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è)
```
üî¥ –¢–†–ï–í–û–ì–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
üñ• –°–µ—Ä–≤–µ—Ä: production-web-1 (xx.xx.xx.xx)

–¢–∏–ø: SSH Brute Force
–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å: HIGH
IP: xx.xx.xx.xx
–°—Ç—Ä–∞–Ω–∞: China (CN)
–í—Ä–µ–º—è: 01:25:33 (MSK)

–î–µ—Ç–∞–ª–∏:
Detected 15 failed SSH login attempts.
SSH access should only come from whitelisted IPs.
This IP is NOT in SSH whitelist.

–î–µ–π—Å—Ç–≤–∏–µ: IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
–í—Å–µ–≥–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 169 IP-–∞–¥—Ä–µ—Å–æ–≤
```

### üü° HTTP —Ç—Ä–∞—Ñ–∏–∫ (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
```
üü° –¢–†–ï–í–û–ì–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
üñ• –°–µ—Ä–≤–µ—Ä: production-web-1 (xx.xx.xx.xx)

–¢–∏–ø: High HTTP Traffic
–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å: LOW
IP: xx.xx.xx.xx
–°—Ç—Ä–∞–Ω–∞: Germany (DE)
–í—Ä–µ–º—è: 14:52:18 (MSK)

–î–µ—Ç–∞–ª–∏:
IP has 150 HTTP/HTTPS connections (threshold: 100).
This might be a busy user or crawler.
NOT automatically blocked unless extreme.

–î–µ–π—Å—Ç–≤–∏–µ: –¢–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
–í—Å–µ–≥–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 169 IP-–∞–¥—Ä–µ—Å–æ–≤
```

### üìä –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á—ë—Ç
```
üìä DAILY REPORT
üñ• production-web-1 (xx.xx.xx.xx)
2025-11-29

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Å—É—Ç–∫–∏:
‚Ä¢ –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ —É–≥—Ä–æ–∑: 47
‚Ä¢ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ IP: 12
‚Ä¢ –í—Å–µ–≥–æ –≤ –±–ª–æ–∫–µ: 180 IPs

–ü–æ —Ç–∏–ø–∞–º:
  ‚Ä¢ SSH Brute Force: 35
  ‚Ä¢ SYN Flood Attack: 8
  ‚Ä¢ Port Scan Detected: 4

–¢–æ–ø —Å—Ç—Ä–∞–Ω-–∞—Ç–∞–∫—É—é—â–∏—Ö:
  ‚Ä¢ China: 25
  ‚Ä¢ Russia: 12
  ‚Ä¢ United States: 6
  ‚Ä¢ India: 4
```

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **GeoIP** ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã –∞—Ç–∞–∫—É—é—â–µ–≥–æ
- ‚úÖ **Rate Limit** ‚Äî –º–∞–∫—Å 5 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É (–Ω–µ —Å–ø–∞–º–∏—Ç –ø—Ä–∏ –º–∞—Å—Å–æ–≤—ã—Ö –∞—Ç–∞–∫–∞—Ö)
- ‚úÖ **Daily Report** ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –≤ 9:00 MSK
- ‚úÖ **–î–≤–∞ whitelist** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ SSH (–∞–¥–º–∏–Ω—ã) –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (–ë–î, –∫—ç—à)
- ‚úÖ **–†—É—Å—Å–∫–∏–π/English** ‚Äî –≤—ã–±–æ—Ä —è–∑—ã–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ **Server Info** ‚Äî –∫–∞–∂–¥–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–º—è –∏ IP —Å–µ—Ä–≤–µ—Ä–∞

## –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

```
/opt/security-monitor/
‚îú‚îÄ‚îÄ security_monitor.py      # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ config.json               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ config.example.json       # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞
‚îú‚îÄ‚îÄ install.sh                # –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫
‚îú‚îÄ‚îÄ requirements.txt          # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ security-commands.md  # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–∞–Ω–¥

/var/log/
‚îú‚îÄ‚îÄ security-monitor.log      # –õ–æ–≥ —Ä–∞–±–æ—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∞
‚îî‚îÄ‚îÄ blocked-ips.log           # –ò—Å—Ç–æ—Ä–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
```

## FAQ

**–ö–∞–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP?**
```bash
iptables -D INPUT -s 1.2.3.4 -j DROP
# –¢–∞–∫–∂–µ —É–¥–∞–ª–∏—Ç—å –∏–∑ /var/log/blocked-ips.log
```

**–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∞?**
```bash
python3 security_monitor.py --add-ssh-whitelist 1.2.3.4
# –∏–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å config.json
systemctl restart security-monitor
```

**–ö–∞–∫ —Å–º–µ–Ω–∏—Ç—å —è–∑—ã–∫ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π?**
```json
{
  "language": "en"
}
```

**–ö–∞–∫ –æ—Ç–∫–ª—é—á–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É?**
```json
{
  "auto_block": false
}
```

–ë—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Linux (Ubuntu, Debian, CentOS)
- Python 3.7+
- –î–æ—Å—Ç—É–ø root (–¥–ª—è iptables)
- –ò–Ω—Ç–µ—Ä–Ω–µ—Ç (–¥–ª—è Telegram API –∏ GeoIP)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - Vigil.sh 2025

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–µ—Ä–≤–µ—Ä–æ–≤ –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.**
